{"ast":null,"code":"const headers = {\n  \"Content-Type\": \"application/json\"\n};\n\nfunction getJson(res) {\n  if (res.ok) {\n    return res.json();\n  }\n\n  return Promise.reject(`Что-то пошло не так: ${res.status}`);\n}\n\n;\n\nfunction getToken() {\n  return fetch(`/ajax/get-csrf-token`, {\n    headers\n  }).then(getJson).then(({\n    data\n  }) => {\n    console.log(data);\n    return {\n      [data.param]: data.token\n    };\n  }).catch(err => console.log(err));\n} //Получаем дерево продуктов\n\n\nexport function get(id) {\n  return fetch(`/restaurant/menu-data?id=${id}`, {\n    headers\n  }).then(getJson);\n}\nexport function remove(product) {\n  const id = product.category_id || product.product_id;\n  const type = product.category_id ? 'category' : 'product';\n  return getToken().then(formData => fetch(`/${type}/delete?id=${id}`, {\n    method: \"POST\",\n    headers,\n    body: JSON.stringify(formData)\n  })).then(res => {\n    if (res.ok || res.status === 302) {\n      return product;\n    }\n\n    return Promise.reject(`Что-то пошло не так: ${res.status}`);\n  });\n}\nexport function saveImage() {\n  //http://lk.foodle.local/product/img-save\n  return new Promise(resolve => setTimeout(() => resolve({\n    data: \"https://s6.cdn.teleprogramma.pro/wp-content/uploads/2020/06/689da5444c44d931d0f97a5df9bda833.jpg\"\n  }), 3000));\n}\nexport function getImageUrl(formData, key) {\n  // return new Promise((resovle) => {\n  //   setTimeout(() => resovle({[key]: \"https://s6.cdn.teleprogramma.pro/wp-content/uploads/2020/06/689da5444c44d931d0f97a5df9bda833.jpg\"}), Math.random() * 5 * 1000);\n  // });\n  return fetch(`/product/img-save`, {\n    method: \"POST\",\n    body: formData\n  }).then(res => {}).then(url => ({\n    [key]: url\n  }));\n}","map":null,"metadata":{},"sourceType":"module"}