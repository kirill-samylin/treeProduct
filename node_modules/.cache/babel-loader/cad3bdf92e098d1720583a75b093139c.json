{"ast":null,"code":"import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport { getProducts } from \"../../services/api\";\nimport { tree } from \"../../utils\";\nconst initialState = {\n  products: [],\n  loading: false\n};\nexport const treeAsync = createAsyncThunk(\"tree/getProducts\", async id => {\n  const response = await getProducts(id);\n  return response.data;\n});\nexport const treeSlice = createSlice({\n  name: \"tree\",\n  initialState,\n  reducers: {\n    changeStatus: (state, action) => {\n      const item = action.payload;\n\n      if (item.hasOwnProperty(\"active\") && item.active || item.hasOwnProperty(\"disabled\") && !item.disabled) {\n        state.products = tree.offBranch(item, state.products);\n      } else {\n        state.products = tree.onBranch(item, state.products);\n      }\n    },\n    changeExpand: (state, action) => {\n      const item = action.payload;\n      state.products = tree.set(item, state.products, 'expanded', !item.expanded);\n    },\n    insert: (state, action) => {\n      const item = action.payload;\n\n      if (item.parent_id === \"root\" && !item.product_id) {\n        state.products = [item, ...state.products.concat()];\n      } else {\n        state.products = tree.insert(item, state.products.concat());\n      }\n    },\n    remove: (state, action) => {\n      const item = action.payload;\n      state.products = tree.remove(item, state.products);\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(treeAsync.pending, state => {\n      state.loading = true;\n    }).addCase(treeAsync.fulfilled, (state, action) => {\n      let list = tree.flatten(items);\n      list = tree.passiveMode(list);\n      const products = tree.get(items, list);\n      state.products = action.payload;\n      state.loading = false;\n    });\n  }\n});\nexport const {\n  changeStatus,\n  changeExpand,\n  insert,\n  remove\n} = treeSlice.actions;\nexport const selectTree = state => {\n  const items = state.tree.products;\n  let list = tree.flatten(items);\n  list = tree.passiveMode(list);\n  const products = tree.get(items, list);\n  return {\n    list,\n    products\n  };\n};\nexport default treeSlice.reducer;","map":{"version":3,"sources":["/Users/kirillsamylin/Desktop/table/stop-list/src/components/App/App.slice.js"],"names":["createAsyncThunk","createSlice","getProducts","tree","initialState","products","loading","treeAsync","id","response","data","treeSlice","name","reducers","changeStatus","state","action","item","payload","hasOwnProperty","active","disabled","offBranch","onBranch","changeExpand","set","expanded","insert","parent_id","product_id","concat","remove","extraReducers","builder","addCase","pending","fulfilled","list","flatten","items","passiveMode","get","actions","selectTree","reducer"],"mappings":"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","sourcesContent":["import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport { getProducts } from \"../../services/api\";\nimport { tree } from \"../../utils\";\n\nconst initialState = {\n  products: [],\n  loading: false,\n};\n\nexport const treeAsync = createAsyncThunk(\n  \"tree/getProducts\",\n  async (id) => {\n    const response = await getProducts(id);\n    return response.data;\n  }\n);\n\nexport const treeSlice = createSlice({\n  name: \"tree\",\n  initialState,\n  reducers: {\n    changeStatus: (state, action) => {\n      const item = action.payload;\n      if ((item.hasOwnProperty(\"active\") && item.active) || (item.hasOwnProperty(\"disabled\") && !item.disabled)) {\n        state.products = tree.offBranch(item, state.products);\n      } else {\n        state.products = tree.onBranch(item, state.products);\n      }\n    },\n    changeExpand: (state, action) => {\n      const item = action.payload;\n      state.products = tree.set(item, state.products, 'expanded', !item.expanded);\n    },\n    insert: (state, action) => {\n      const item = action.payload;\n      if (item.parent_id === \"root\" && !item.product_id) {\n        state.products = [item, ...state.products.concat()];\n      } else {\n        state.products = tree.insert(item, state.products.concat());\n      }\n    },\n    remove: (state, action) => {\n      const item = action.payload;\n      state.products = tree.remove(item, state.products);\n    },\n  },\n  extraReducers: (builder) => {\n    builder\n      .addCase(treeAsync.pending, (state) => {\n        state.loading = true;\n      })\n      .addCase(treeAsync.fulfilled, (state, action) => {\n        let list = tree.flatten(items);\n      list = tree.passiveMode(list);\n      const products = tree.get(items, list);\n        state.products = action.payload;\n        state.loading = false;\n      });\n  },\n});\n\nexport const { changeStatus, changeExpand, insert, remove } = treeSlice.actions;\n\nexport const selectTree = (state) => {\n  const items = state.tree.products;\n  let list = tree.flatten(items);\n  list = tree.passiveMode(list);\n  const products = tree.get(items, list);\n  return { list, products };\n};\n\nexport default treeSlice.reducer;\n"]},"metadata":{},"sourceType":"module"}