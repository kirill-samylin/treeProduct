{"ast":null,"code":"import _defineProperty from\"/Users/kirillsamylin/Desktop/job/foodle-api/src/lk/web/js/react/tree/node_modules/@babel/runtime/helpers/esm/defineProperty\";import React,{createRef,useEffect,memo}from\"react\";import styles from\"./Tree.module.css\";import{Category,Product}from\"../\";import cn from\"classnames\";import{useDispatch}from\"react-redux\";import{move}from\"./Tree.slice\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var Tree=/*#__PURE__*/memo(function(_ref){var id=_ref.id,categories=_ref.categories,products=_ref.products,className=_ref.className,expanded=_ref.expanded;var treeElement=/*#__PURE__*/createRef(null);var dispatch=useDispatch();var onEnd=function onEnd(evt){var oldIndex=evt.oldIndex;var index=evt.newIndex;var item=evt.item;var parent=evt.to;var oldParent=evt.from;var id=item.dataset.id;var name=item.dataset.name;var categoryId=parent.dataset.id;var oldCategoryId=oldParent.dataset.id;if(oldIndex===index&&parent===oldParent)return;var obj={parent_id:categoryId,type:name};if(name===\"category\"){obj.category_id=id;}else{obj.product_id=id;}console.log({\"id предмета\":id,\"id категории куда суем\":categoryId,\"id категории откуда удаляем\":oldCategoryId,\"index - место куда вставляем\":index,\"oldIndex - место откуда вырезаем\":oldIndex,\"тип\":name});};var onMove=function onMove(evt){var parent=evt.to;var item=evt.dragged;var category_id=parent.dataset.id;var name=item.dataset.name;if(category_id===\"root\"&&name===\"product\")return false;return true;};useEffect(function(){window.$(treeElement.current).sortable({fallbackOnBody:false,// selectedClass: styles.selected,\n// multiDrag: true,\ngroup:{name:\"list\"},animation:200,ghostClass:\"ghost\",handle:\".position\",onEnd:onEnd,onMove:onMove});},[treeElement]);return/*#__PURE__*/_jsxs(\"ul\",{ref:treeElement,\"data-id\":id,className:cn(styles.tree,className,\"list-group\",_defineProperty({},styles.open,expanded)),children:[Array.isArray(products)&&products.map(function(product){return/*#__PURE__*/_jsx(Product,{product:product},product.product_id);}),Array.isArray(categories)&&categories.map(function(category){return/*#__PURE__*/_jsx(Category,{product:category},category.category_id);})]});});","map":null,"metadata":{},"sourceType":"module"}