{"ast":null,"code":"import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport * as api from \"../../services/api\";\nimport { tree } from \"../../utils\";\nimport { localeProducts } from \"../../services/localeProducts\";\nconst initialState = {\n  products: [],\n  loading: false\n};\nexport const getAsync = createAsyncThunk(\"tree/get\", async restaurant_id => {\n  if (restaurant_id === \"test\") {\n    return localeProducts;\n  }\n\n  return await api.get(restaurant_id);\n});\nexport const removeAsync = createAsyncThunk(\"tree/remove\", async product => {\n  if (product.id === \"test\") {\n    return product;\n  }\n\n  return await api.remove(product);\n});\nexport const treeSlice = createSlice({\n  name: \"tree\",\n  initialState,\n  reducers: {\n    changeStatus: (state, action) => {\n      const item = action.payload;\n\n      if (item.hasOwnProperty(\"active\") && item.active || item.hasOwnProperty(\"disabled\") && !item.disabled) {\n        state.products = tree.offBranch(item, state.products);\n      } else {\n        state.products = tree.onBranch(item, state.products);\n      }\n    },\n    changeExpand: (state, action) => {\n      const item = action.payload;\n      state.products = tree.set(item, state.products, 'expanded', !item.expanded);\n    },\n    insert: (state, action) => {\n      const item = action.payload;\n      state.products = tree.insert(item, state.products);\n    },\n    remove: (state, action) => {\n      const item = action.payload;\n      state.products = tree.remove(item, state.products);\n    },\n    move: (state, action) => {\n      const item = action.payload;\n      tree.move(item, state.products);\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(getAsync.pending, state => {\n      state.loading = true;\n    }).addCase(getAsync.fulfilled, (state, action) => {\n      state.products = action.payload;\n      state.loading = false;\n    }).addCase(getAsync.rejected, state => {\n      state.products = localeProducts;\n      state.loading = false;\n    }).addCase(removeAsync.pending, state => {\n      state.loading = true;\n    }).addCase(removeAsync.fulfilled, (state, action) => {\n      const item = action.payload;\n      state.products = tree.remove(item, state.products);\n      state.loading = false;\n    });\n  }\n});\nexport const {\n  changeStatus,\n  changeExpand,\n  insert,\n  remove\n} = treeSlice.actions;\nexport const selectTree = state => {\n  const items = state.tree.products;\n  let list = tree.flatten(items);\n  list = tree.passiveMode(list);\n  const products = tree.get(items, list);\n  return {\n    list,\n    products\n  };\n};\nexport default treeSlice.reducer;","map":null,"metadata":{},"sourceType":"module"}