{"ast":null,"code":"import _defineProperty from\"/Users/kirillsamylin/Desktop/job/foodle-api/src/lk/web/js/react/tree/node_modules/@babel/runtime/helpers/esm/defineProperty\";var headers={\"Content-Type\":\"application/json\"};function getJson(res){if(res.ok){return res.json();}return Promise.reject(\"\\u0427\\u0442\\u043E-\\u0442\\u043E \\u043F\\u043E\\u0448\\u043B\\u043E \\u043D\\u0435 \\u0442\\u0430\\u043A: \".concat(res.status));};function getTokenData(){return fetch(\"/ajax/get-csrf-token\",{headers:headers}).then(getJson).then(function(_ref){var data=_ref.data;console.log(data);return _defineProperty({},data.param,data.token);});}function getToken(){return fetch(\"/ajax/get-csrf-token\",{headers:headers}).then(getJson).then(function(_ref3){var data=_ref3.data;return data.token;});}//Получаем дерево продуктов\nexport function get(id){return fetch(\"/restaurant/menu-data?id=\".concat(id),{headers:headers}).then(getJson);}export function remove(product){var id=product.category_id||product.product_id;var type=product.category_id?'category':'product';return getTokenData().then(function(formData){return fetch(\"/\".concat(type,\"/delete?id=\").concat(id),{method:\"POST\",headers:headers,body:JSON.stringify(formData)});}).then(function(res){if(res.ok||res.status===302){return product;}return Promise.reject(\"\\u0427\\u0442\\u043E-\\u0442\\u043E \\u043F\\u043E\\u0448\\u043B\\u043E \\u043D\\u0435 \\u0442\\u0430\\u043A: \".concat(res.status));});}export function saveImage(){//http://lk.foodle.local/product/img-save\nreturn new Promise(function(resolve){return setTimeout(function(){return resolve({data:\"https://s6.cdn.teleprogramma.pro/wp-content/uploads/2020/06/689da5444c44d931d0f97a5df9bda833.jpg\"});},3000);});}export function getImageUrl(formData,key){// return new Promise((resovle) => {\n//   setTimeout(() => resovle({[key]: \"https://s6.cdn.teleprogramma.pro/wp-content/uploads/2020/06/689da5444c44d931d0f97a5df9bda833.jpg\"}), Math.random() * 5 * 1000);\n// });\nreturn getToken().then(function(token){return fetch(\"/product/img-save\",{method:\"POST\",headers:{\"Accept-Content-Type\":\"text/html\",\"X-Requested-With\":\"XMLHttpRequest\",\"X-CSRF-Token\":token},body:formData});}).then(function(res){if(res.ok){return res.body;}return Promise.reject(\"\\u0427\\u0442\\u043E-\\u0442\\u043E \\u043F\\u043E\\u0448\\u043B\\u043E \\u043D\\u0435 \\u0442\\u0430\\u043A: \".concat(res.status));}).then(function(url){return _defineProperty({},key,url);});}","map":null,"metadata":{},"sourceType":"module"}