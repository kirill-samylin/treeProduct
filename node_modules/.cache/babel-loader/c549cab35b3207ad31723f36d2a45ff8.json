{"ast":null,"code":"var _jsxFileName = \"/Users/kirillsamylin/Desktop/table/stop-list/src/components/PopupCropper/PopupCropper.js\",\n    _s = $RefreshSig$();\n\nimport React, { useRef, useState } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport Cropper from \"react-cropper\";\nimport \"cropperjs/dist/cropper.css\";\nimport styles from \"./PopupCropper.module.css\";\nimport cn from \"classnames\";\nimport { Popup } from \"../\";\nimport { Button } from \"react-bootstrap\";\nimport * as cropperSlice from \"./PopupCropper.slice\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst style = {\n  width: 750,\n  height: 470\n};\nconst options = {\n  aspectRatio: 75 / 47,\n  autoCropArea: 1,\n  style\n};\nexport const PopupCropper = () => {\n  _s();\n\n  const [cropper, setCropper] = useState();\n  const cropperRef = useRef(null);\n  const dispatch = useDispatch();\n  const state = useSelector(cropperSlice.selectState);\n  const image = useSelector(cropperSlice.selectImage);\n\n  function handleCropper(cropper) {\n    setError(\"\");\n    const result = document.querySelector(\"#cropper__result\");\n    const image = cropper.toDataURL(\"image/png\");\n    sendPhoto(image);\n    result.src = image;\n    const container = document.querySelector(\".cropper-container\");\n\n    if (container) {\n      container.classList.add(\"cropper_hidden\");\n    }\n  }\n\n  const getCropData = () => {\n    if (typeof cropper !== \"undefined\") {\n      const formData = new FormData();\n      const blob = new Blob([image], {\n        type: \"image/png\"\n      });\n      formData.append(\"image\", blob);\n      console.log(cropper.getCroppedCanvas().toDataURL());\n    }\n  };\n\n  const onClose = () => {\n    dispatch(cropperSlice.handleClose());\n  };\n\n  return /*#__PURE__*/_jsxDEV(Popup, {\n    className: styles.popup,\n    classContainer: styles.container,\n    opened: state,\n    children: [/*#__PURE__*/_jsxDEV(Cropper, {\n      src: image || '',\n      ...options,\n      ref: cropperRef,\n      onInitialized: instance => {\n        setCropper(instance);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.buttons,\n      children: [/*#__PURE__*/_jsxDEV(Button, {\n        onClick: getCropData,\n        children: \"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        onClick: onClose,\n        variant: \"secondary\",\n        children: \"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0430\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 57,\n    columnNumber: 5\n  }, this);\n};\n\n_s(PopupCropper, \"s5rco5DzFZKlL8YEehwrRPvuGf4=\", false, function () {\n  return [useDispatch, useSelector, useSelector];\n});\n\n_c = PopupCropper;\n\nvar _c;\n\n$RefreshReg$(_c, \"PopupCropper\");","map":{"version":3,"sources":["/Users/kirillsamylin/Desktop/table/stop-list/src/components/PopupCropper/PopupCropper.js"],"names":["React","useRef","useState","useSelector","useDispatch","Cropper","styles","cn","Popup","Button","cropperSlice","style","width","height","options","aspectRatio","autoCropArea","PopupCropper","cropper","setCropper","cropperRef","dispatch","state","selectState","image","selectImage","handleCropper","setError","result","document","querySelector","toDataURL","sendPhoto","src","container","classList","add","getCropData","formData","FormData","blob","Blob","type","append","console","log","getCroppedCanvas","onClose","handleClose","popup","instance","buttons"],"mappings":"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","sourcesContent":["import React, { useRef, useState } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport Cropper from \"react-cropper\";\nimport \"cropperjs/dist/cropper.css\";\nimport styles from \"./PopupCropper.module.css\";\nimport cn from \"classnames\";\nimport { Popup } from \"../\";\nimport { Button } from \"react-bootstrap\";\nimport * as cropperSlice from \"./PopupCropper.slice\";\n\nconst style = {\n  width: 750,\n  height: 470,\n};\n\nconst options = {\n  aspectRatio: 75 / 47,\n  autoCropArea: 1,\n  style,\n};\n\nexport const PopupCropper = () => {\n  const [ cropper, setCropper ] = useState();\n\n  const cropperRef = useRef(null);\n  const dispatch = useDispatch();\n  const state = useSelector(cropperSlice.selectState);\n  const image = useSelector(cropperSlice.selectImage);\n\n  function handleCropper(cropper) {\n    setError(\"\");\n    const result = document.querySelector(\"#cropper__result\");\n    const image = cropper.toDataURL(\"image/png\");\n    sendPhoto(image);\n    result.src = image;\n    const container = document.querySelector(\".cropper-container\");\n    if (container) {\n      container.classList.add(\"cropper_hidden\");  \n    }\n  }\n\n  const getCropData = () => {\n    if (typeof cropper !== \"undefined\") {\n      const formData = new FormData();\n      const blob = new Blob([image], { type: \"image/png\"});\n      formData.append(\"image\", blob);\n\n      console.log(cropper.getCroppedCanvas().toDataURL());\n    }\n  };\n\n  const onClose = () => {\n    dispatch(cropperSlice.handleClose());\n  };\n\n  return (\n    <Popup className={styles.popup} classContainer={styles.container} opened={state}>\n      <Cropper\n        src={image || ''}\n        {...options}\n        ref={cropperRef}\n        onInitialized={(instance) => {\n          setCropper(instance);\n        }}\n      />\n      <div className={styles.buttons}>\n        <Button onClick={getCropData}>Добавить</Button>\n        <Button onClick={onClose} variant=\"secondary\">Отмена</Button>\n      </div>\n    </Popup>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}