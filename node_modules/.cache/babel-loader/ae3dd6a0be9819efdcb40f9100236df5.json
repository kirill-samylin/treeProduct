{"ast":null,"code":"import _objectSpread from\"/Users/kirillsamylin/Desktop/job/foodle-api/src/lk/web/js/react/tree/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _createForOfIteratorHelper from\"/Users/kirillsamylin/Desktop/job/foodle-api/src/lk/web/js/react/tree/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _slicedToArray from\"/Users/kirillsamylin/Desktop/job/foodle-api/src/lk/web/js/react/tree/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useRef,useState,useCallback}from\"react\";import styles from\"./ImageCropperPopup.module.css\";import{Popup}from\"../..\";import Cropper from\"react-cropper\";import{Button}from\"react-bootstrap\";import{selectState,selectImage,handleClose,saveImageAsync,getImageUrlAsync}from\"../ImageCropper.slice\";import{useSelector,useDispatch}from\"react-redux\";import{defaultType,defaultWidth,defaultHeight,defaultQuality}from\"../../../constants/cropper\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ImageCropperPopup=function ImageCropperPopup(_ref){var cropperOptions=_ref.cropperOptions,formats=_ref.formats;var cropperRef=useRef(null);var _useState=useState(''),_useState2=_slicedToArray(_useState,2),cropper=_useState2[0],setCropper=_useState2[1];var state=useSelector(selectState);var image=useSelector(selectImage);var dispatch=useDispatch();var onClose=useCallback(function(){dispatch(handleClose());},[dispatch]);var getCropData=useCallback(function(){if(typeof cropper!==\"undefined\"){var images=[];var _iterator=_createForOfIteratorHelper(formats),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var format=_step.value;var croppImage=cropper.getCroppedCanvas({width:format.width||defaultWidth,height:format.height||defaultHeight,imageSmoothingQuality:format.quality||defaultQuality}).toDataURL();images.push({blob:new Blob([croppImage],{type:format.type||defaultType}),key:format.key});}}catch(err){_iterator.e(err);}finally{_iterator.f();}dispatch(getImageUrlAsync(images));}},[cropper,formats,dispatch]);return/*#__PURE__*/_jsxs(Popup,{className:styles.popup,classContainer:styles.container,opened:state,children:[/*#__PURE__*/_jsx(Cropper,_objectSpread(_objectSpread({src:image||\"\"},cropperOptions),{},{ref:cropperRef,onInitialized:function onInitialized(instance){setCropper(instance);}})),/*#__PURE__*/_jsxs(\"div\",{className:styles.buttons,children:[/*#__PURE__*/_jsx(Button,{onClick:getCropData,children:\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C\"}),/*#__PURE__*/_jsx(Button,{onClick:onClose,variant:\"secondary\",children:\"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0430\"})]})]});};export default ImageCropperPopup;","map":null,"metadata":{},"sourceType":"module"}